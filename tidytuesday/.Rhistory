geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = 50,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = 20,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = -2,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = -10,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = 4,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
fontface="bold",
size=city_size,
arrow=my_arrow,
nudge_y = 2,
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = 4,
fontface="bold",
size=city_size,
arrow=my_arrow
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = 1.5,
fontface="bold",
size=city_size,
arrow=my_arrow
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = 1.5,
fontface="bold",
size=city_size
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = 1.5,
fontface="bold",
size=city_size
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = -1.5,
fontface="bold",
size=city_size
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
base_plot <- ggplot()+
geom_sf(data=counties66 ,aes(geometry=geom),colour=county_border, size=0.5,fill=county_fill,inherit.aes = FALSE) +
geom_sf(data=route66 ,aes(geometry=geometry),colour=route66_fill, alpha=1,size=2,inherit.aes = FALSE) +
geom_sf(data=cities66 ,aes(geometry=geometry),fill=city_fill, alpha=1,size=0,inherit.aes = FALSE) +
geom_sf_text_repel(data = cities66 %>% filter(group==1),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,                           #it doesn't like vectors, unlike geom_text_repel
box.padding = 0.5,
nudge_y = 1.6,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==2),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,
box.padding = 0.5,
nudge_y = -1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==3),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = -1,
box.padding = 0.5,
nudge_y = 1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==4),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=120,
nudge_x = -20,
nudge_y = -50,
box.padding = 0.5,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
custom_map_theme(legend_pos = "none", plot_margin = c(0,0,0,0)) +
theme(panel.background = element_rect(fill=lighten(county_fill,0.1),
colour = lighten(county_border,0.2)))
base_plot <- ggplot()+
geom_sf(data=counties66 ,aes(geometry=geom),colour=county_border, size=0.5,fill=county_fill,inherit.aes = FALSE) +
geom_sf(data=route66 ,aes(geometry=geometry),colour=route66_fill, alpha=1,size=2,inherit.aes = FALSE) +
geom_sf(data=cities66 ,aes(geometry=geometry),fill=city_fill, alpha=1,size=0,inherit.aes = FALSE) +
geom_sf_text_repel(data = cities66 %>% filter(group==1),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,                           #it doesn't like vectors, unlike geom_text_repel
box.padding = 0.5,
nudge_y = 1.6,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==2),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,
box.padding = 0.5,
nudge_y = -1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==3),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = -1,
box.padding = 0.5,
nudge_y = 1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==4),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=120,
nudge_x = -20,
nudge_y = -50,
box.padding = 0.5,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
custom_map_theme(legend_pos = "none") + #, plot_margin = c(0,0,0,0)) +
theme(panel.background = element_rect(fill=lighten(county_fill,0.1),
colour = lighten(county_border,0.2)))
base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text_repel(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = -1.5,
fontface="bold",
size=city_size
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
librarian::shelf("tidyverse",                 # no intro required
"stringi",
"patchwork",                 # plotting aggregation
"here",
"ggtext",                     # element_markdown()
"yutannihilation/ggsflabel",  #labels for sf plots
"carlosyanez/customthemes",   # personal library with custom themes
"maps",                       #US Maps
"osmdata",
"sf",
"units",
"tigris",
"showtext",
"sysfonts",
"tinter",
"grid",
"cowplot",
"ggimage"
)
ggbackground(cp, here(tt_date,"route66.png"))
ggbackground(cp, here(tt_date,"route66.png"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.285, y=0.453)
ggbackground(cp, here(tt_date,"route66.png"))
ggbackground(cp, here(tt_date,"route66.png"))
ggbackground(p, here(tt_date,"route66.png"))
p
plot_caption <-str_c('**Sources** : Cameron Blevins and Richard W. Helbock via tidytuesday |<br>",
"TIGER/Line | US National Park Service | {maps} | Bobby Troup',
"<br>",
add_social_ref("@carlosyanez"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
plot_caption <-str_c('**Sources** : Cameron Blevins and Richard W. Helbock via tidytuesday |",
"<br>",
"TIGER/Line | US National Park Service | {maps} | Bobby Troup',
"<br>",
add_social_ref("@carlosyanez"))
plot_caption
plot_caption <-str_c('**Sources** : Cameron Blevins and Richard W. Helbock via tidytuesday",
"<br>",
"| TIGER/Line | US National Park Service | {maps} | Bobby Troup',
"<br>",
add_social_ref("@carlosyanez"))
plot_caption
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday",
"<br>",
"| TIGER/Line | US National Park Service | {maps} | Bobby Troup',
"<br>",
add_social_ref("@carlosyanez"))
plot_caption
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday',
add_social_ref("@carlosyanez"))
plot_caption
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday, <br>',
add_social_ref("@carlosyanez"))
plot_caption
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday, <br>',
"US National Park Service, TIGER/Line, {maps}, and Bobby Troup"
add_social_ref("@carlosyanez"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.background = element_rect(fill="transparent",colour=NA),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.285, y=0.453)
cp
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday,','<br>',
'US National Park Service, TIGER/Line, {maps}, and Bobby Troup','<br>',
add_social_ref("@carlosyanez"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
#plot.background = element_rect(fill=bg_colour),
plot.background = element_rect(fill="transparent",colour=NA),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.285, y=0.453)
ggbackground(p, here(tt_date,"route66.png"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.285, y=0.453)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.285, y=0.653)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.385, y=0.653)
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.3, y=0.653)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.2, y=0.653)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0, y=0.653)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
p2<- base_plot +
geom_sf(data= post_offices_66 %>% filter(!opened_after_ref & !closed_before_ref & !(decade_discountinued=="Open")),
aes(geometry=geometry, colour=`Closed on`),size=3,alpha=0.5,inherit.aes = FALSE) +
geom_sf(data = post_office_winona,
aes(geometry=geometry),colour=winona_colour,size=3)+
geom_sf_text(data = post_office_winona,
aes(geometry=geometry, label = label),
colour=winona_colour,
family=city_font,
nudge_y = -1.5,
fontface="bold",
size=city_size
) +
theme(legend.position = "bottom") +
labs(subtitle = str_c("**Closed** from ",ref_year," onwards"))
#putting plots together
plot_title <- str_c("Winona was forgotten")
plot_subtitle <- str_c("*Post Office closures along Route 66 from ",ref_year," onwards* <br>")
plot_caption <-str_c('**Sources**: Cameron Blevins and Richard W. Helbock via tidytuesday,',
'US National Park Service, TIGER/Line, {maps}, and Bobby Troup','<br>',
add_social_ref("@carlosyanez"))
p<- p1 / p2  + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=google_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.2)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0, y=0.653)
p
p2
