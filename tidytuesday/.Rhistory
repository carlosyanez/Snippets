B"
p1 + p2  + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=city_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1 + p2  + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p3 <- ggplot()
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
plot_title <- str_c("Winona has been forgotten")
plot_subtitle <- str_c("*Post Office closures along Route 66 from ",ref_year," onwards*")
plot_caption <-str_c(str_c('**Sources:** Cameron Blevins and Richard W. Helbock, US National Park Service, TIGER/Line, {maps}, and Bobby Troup'),
'<br><br>',
add_social_ref("@carlosyanez"))
p3 <- ggplot()
layout <- "A
B"
p <- p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,3)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,1)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) *
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,1)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,1)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p3 <- ggplot() +theme_minimal()
p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.46, y=0.455)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
lot_caption <-str_c(str_c('**Sources:** Blevins, Cameron and Helbock, Richard W., US National Park Service, TIGER/Line, {maps}, and Bobby Troup'),
'<br><br>',
add_social_ref("@carlosyanez"))
p3 <- ggplot() ### extra dumb plot seems to correct issues with spacing and rmarkdown
layout <- "A
B"
p <- p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.46, y=0.455)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
plot_caption <-str_c(str_c('**Sources:** Blevins, Cameron and Helbock, Richard W., US National Park Service, TIGER/Line, {maps}, and Bobby Troup'),
'<br><br>',
add_social_ref("@carlosyanez"))
p3 <- ggplot() ### extra dumb plot seems to correct issues with spacing and rmarkdown
layout <- "A
B"
p <- p1 + p2 + p3 + plot_layout(design=layout,widths=1) +
plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=google_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
## image from https://imgbin.com/png/d72xgBtC/u-s-route-66-in-california-oatman-interstate-40-road-png
cp <- ggdraw(p) +
draw_image(here(tt_date,"route66.png"),
scale = .08, x =0.46, y=0.455)
##save on file
wv <- 12
save_image(cp,here(tt_date,"post_office_route66.png"),width=wv,height=wv*0.85)
librarian::shelf("tidyverse","sf","patchwork","cowplot","ggtext",
"showtext","sysfonts","units","tinter","here",
"yutannihilation/ggsflabel","ggrepel",
"carlosyanez/customthemes","ggrastr",
"maps","tigris","grid")
options(ggrastr.default.dpi=750)
ggplot()+
rasterise(geom_sf(data=counties66 ,aes(geometry=geom),colour=county_border, size=0.5,fill=county_fill,inherit.aes = FALSE)) +
geom_sf(data=route66 ,aes(geometry=geometry),colour=route66_fill, alpha=1,size=2,inherit.aes = FALSE) +
geom_sf(data=cities66 ,aes(geometry=geometry),fill=city_fill, alpha=1,size=0,inherit.aes = FALSE) +
geom_sf_text_repel(data = cities66 %>% filter(group==1),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,
direction ="both",
point.padding = 0.1,
box.padding = 0.5,
nudge_y = 1.6,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20) +
geom_sf_text_repel(data = cities66 %>% filter(group==2),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = 1,
direction ="both",
point.padding = 0.1,
box.padding = 0.5,
nudge_y = -1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==3),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = -1,
direction ="both",
point.padding = 0.1,
box.padding = 0.5,
nudge_y = 1.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
geom_sf_text_repel(data = cities66 %>% filter(group==4),
aes(geometry=geometry, label = NAME),
colour=text_colour,
family=city_font,
size=city_size,
force=10,
nudge_x = -2,
nudge_y = -5,
box.padding = 0.5,
direction ="both",
point.padding = 0.1,
segment.curvature = -0.1,
segment.ncp = 3,
segment.angle = 20,
arrow=my_arrow) +
custom_map_theme_md(legend_pos = "none", plot_margin = c(0,0,0,0)) +
theme(panel.background = element_rect(fill=lighten(county_fill,0.1),
colour = lighten(county_border,0.2)))
plot_grid(p1,p2,ncol=1)
ggdraw() +
draw_label(
plot_title
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
text=element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
text=element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
text=element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
text=element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
title <- ggdraw() +
draw_label(
plot_title,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
plot_grid(
title, plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
plot_grid(
title, plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
subtitle <- ggdraw() +
draw_label(
plot_subtitle,
fontface = 'bold',
x = 0,
hjust = 0
) +
subtitle(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
plot_grid(
title, subtitle,plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
subtitle <- ggdraw() +
draw_label(
plot_subtitle,
fontface = 'bold',
x = 0,
hjust = 0
) +
subtitle(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
subtitle <- ggdraw() +
draw_label(
plot_subtitle,
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7),
plot.title = element_markdown(size = 25,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2))
)
plot_grid(
title, subtitle,plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
plot_grid(
title, subtitle,plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
p<-plot_grid(p1,p2,ncol=1)
p
plot_grid(p1,p2,ncol=1) + + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=city_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
plot_grid(p1,p2,ncol=1) + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=city_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
p1<- plot_grid(
title, subtitle,plot_grid(p1,p2,ncol=1),
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
) + theme( plot.background = element_rect(fill=bg_colour))
plot_grid(p1,p2,ncol=1) + plot_annotation(title=plot_title,subtitle = plot_subtitle,caption = plot_caption) &
theme(plot.title.position = "plot",
plot.background = element_rect(fill=bg_colour),
plot.title = element_markdown(size = 18,family=city_font,face="bold",
hjust=0,colour=darken(text_colour,0.2)),
plot.subtitle = element_markdown(size = 12,family=city_font,hjust=0,
colour=darken(text_colour,0.08)),
plot.caption = element_markdown(size = 10,hjust=0,vjust=0,family=google_font)
)
